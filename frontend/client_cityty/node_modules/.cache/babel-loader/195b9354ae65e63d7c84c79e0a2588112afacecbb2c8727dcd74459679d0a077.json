{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/thoma/Desktop/CITYTY/frontend/client_cityty/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/thoma/Desktop/CITYTY/frontend/client_cityty/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/thoma/Desktop/CITYTY/frontend/client_cityty/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Button,TextField}from\"@mui/material\";import React,{useState}from\"react\";import axios from\"axios\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";var ProfilPage=function ProfilPage(_ref){var user=_ref.user,setUser=_ref.setUser;var _useState=useState(),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var ChangeYourPassword=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var formField;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:formField=new FormData();//same names as django database fields\nformField.append(\"email\",user.email);_context.prev=2;_context.next=5;return axios({method:\"post\",url:\"https://cityty-server-fe9e2e38c772.herokuapp.com/api/forgotpassword/\",data:formField});case 5:alert(\"Un lien de r\\xE9initialisation a \\xE9t\\xE9 envoy\\xE9 \\xE0 \".concat(user.email));_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](2);alert(\"Erreur de connexion, le lien de réinitialisation n'a pas été envoyé...\");case 11:case\"end\":return _context.stop();}},_callee,null,[[2,8]]);}));return function ChangeYourPassword(){return _ref2.apply(this,arguments);};}();var ChangeUsername=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var formField,token;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:formField=new FormData();//same names as django database fields\nformField.append(\"username\",username);token=localStorage.getItem(\"token\");_context2.prev=3;_context2.next=6;return axios({method:\"post\",url:\"https://cityty-server-fe9e2e38c772.herokuapp.com/api/change_username/\",data:formField,headers:{Authorization:\"Token \".concat(token)}}).then(function(response){alert(response.data);fetchData();});case 6:_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](3);alert(\"Ce nom d'utilisateur ne convient pas ou est déjà utilisé...\");case 11:case\"end\":return _context2.stop();}},_callee2,null,[[3,8]]);}));return function ChangeUsername(){return _ref3.apply(this,arguments);};}();var fetchData=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var token,response;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:token=localStorage.getItem(\"token\");_context3.prev=1;_context3.next=4;return axios.get(\"https://cityty-server-fe9e2e38c772.herokuapp.com/api/user_profil/\",{headers:{Authorization:\"Token \".concat(token)}});case 4:response=_context3.sent;console.log(user);setUser(response.data);_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](1);console.error(\"Erreur lors de la récupération des données de l'utilisateur :\",_context3.t0);case 12:case\"end\":return _context3.stop();}},_callee3,null,[[1,9]]);}));return function fetchData(){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"profilPageBox\",children:[/*#__PURE__*/_jsxs(\"text\",{className:\"textProfil1\",children:[\"Email : \",user.email]}),/*#__PURE__*/_jsxs(\"text\",{className:\"textProfil1\",children:[\"Username : \",user.username]}),/*#__PURE__*/_jsxs(\"div\",{className:\"boxChangePassword\",children:[/*#__PURE__*/_jsx(TextField,{id:\"password\",label:\"Change your username\",size:\"normal\",variant:\"filled\",value:username,onChange:function onChange(e){return setUsername(e.target.value);}}),/*#__PURE__*/_jsx(\"div\",{className:\"BoxValiderUsername\",children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:function onClick(){return ChangeUsername();},children:\"Confirm\"})})]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:function onClick(){return ChangeYourPassword();},children:\"Reset your password\"})]});};export default ProfilPage;","map":{"version":3,"names":["Button","TextField","React","useState","axios","jsxs","_jsxs","jsx","_jsx","ProfilPage","_ref","user","setUser","_useState","_useState2","_slicedToArray","username","setUsername","ChangeYourPassword","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","formField","wrap","_callee$","_context","prev","next","FormData","append","email","method","url","data","alert","concat","t0","stop","apply","arguments","ChangeUsername","_ref3","_callee2","token","_callee2$","_context2","localStorage","getItem","headers","Authorization","then","response","fetchData","_ref4","_callee3","_callee3$","_context3","get","sent","console","log","error","className","children","id","label","size","variant","value","onChange","e","target","onClick"],"sources":["C:/Users/thoma/Desktop/CITYTY/frontend/client_cityty/src/components/ProfilPage.js"],"sourcesContent":["import { Button, TextField } from \"@mui/material\";\r\nimport React, { useState } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nconst ProfilPage = ({ user, setUser }) => {\r\n  const [username, setUsername] = useState();\r\n\r\n  const ChangeYourPassword = async () => {\r\n    let formField = new FormData();\r\n    //same names as django database fields\r\n    formField.append(\"email\", user.email);\r\n    try {\r\n      await axios({\r\n        method: \"post\",\r\n        url: `https://cityty-server-fe9e2e38c772.herokuapp.com/api/forgotpassword/`,\r\n        data: formField,\r\n      });\r\n      alert(`Un lien de réinitialisation a été envoyé à ${user.email}`);\r\n    } catch {\r\n      alert(\"Erreur de connexion, le lien de réinitialisation n'a pas été envoyé...\");\r\n    }\r\n  };\r\n\r\n  const ChangeUsername = async () => {\r\n    let formField = new FormData();\r\n    //same names as django database fields\r\n    formField.append(\"username\", username);\r\n    const token = localStorage.getItem(\"token\");\r\n    try {\r\n      await axios({\r\n        method: \"post\",\r\n        url: `https://cityty-server-fe9e2e38c772.herokuapp.com/api/change_username/`,\r\n        data: formField,\r\n        headers: {\r\n          Authorization: `Token ${token}`,\r\n        },\r\n      }).then((response) => {\r\n        alert(response.data);\r\n        fetchData();\r\n      });\r\n    } catch {\r\n      alert(\"Ce nom d'utilisateur ne convient pas ou est déjà utilisé...\");\r\n    }\r\n  };\r\n\r\n  const fetchData = async () => {\r\n    const token = localStorage.getItem(\"token\");\r\n    try {\r\n      const response = await axios.get(\r\n        \"https://cityty-server-fe9e2e38c772.herokuapp.com/api/user_profil/\",\r\n        {\r\n          headers: {\r\n            Authorization: `Token ${token}`,\r\n          },\r\n        }\r\n      );\r\n      console.log(user)\r\n      setUser(response.data);\r\n    } catch (error) {\r\n      console.error(\r\n        \"Erreur lors de la récupération des données de l'utilisateur :\",\r\n        error\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"profilPageBox\">\r\n      <text className=\"textProfil1\">Email : {user.email}</text>\r\n      <text className=\"textProfil1\">Username : {user.username}</text>\r\n      <div className=\"boxChangePassword\">\r\n        <TextField\r\n          id=\"password\"\r\n          label=\"Change your username\"\r\n          size=\"normal\"\r\n          variant=\"filled\"\r\n          value={username}\r\n          onChange={(e) => setUsername(e.target.value)}\r\n        />\r\n        <div className=\"BoxValiderUsername\">\r\n          <Button variant=\"contained\" onClick={() => ChangeUsername()}>\r\n            Confirm\r\n          </Button>\r\n        </div>\r\n      </div>\r\n      <Button variant=\"contained\" onClick={() => ChangeYourPassword()}>\r\n        Reset your password\r\n      </Button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProfilPage;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}